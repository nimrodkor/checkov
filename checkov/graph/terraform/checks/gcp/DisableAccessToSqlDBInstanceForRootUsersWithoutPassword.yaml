metadata:
  id: "CKV_GCP_68"
  name: "Ensure that a MySQL database instance does not allow anyone to connect with administrative privileges"
  category: "IAM"
  supported_resources:
    - google_sql_database_instance
scope:
  provider: "GCP"
definition:
  and:
    - cond_type: filter
      attribute: resource_type
      value:
        - google_sql_database_instance
      operator: within
    - or:
        - resource_types:
            - google_sql_database_instance
          connected_resource_types:
            - google_sql_user
          operator: not_exists
          cond_type: connection
        - and:
            - resource_types:
                - google_sql_database_instance
              connected_resource_types:
                - google_sql_user
              operator: exists
              cond_type: connection
            - or:
                - cond_type: attribute
                  attribute: name
                  operator: not_starting_with
                  value: "root"
                - and:
                    - cond_type: attribute
                      attribute: name
                      operator: starting_with
                      value: "root"
                    - cond_type: attribute
                      attribute: password
                      operator: exists



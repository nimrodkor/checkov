metadata:
  id: "CKV2_AWS_22"
  name: "Ensure that IAM groups includes at least one IAM user"
  guidelines: ""
  category: "IAM"
scope:
  provider: "AWS"
definition:
  and:
    - resource_types:
        - aws_iam_group
      connected_resource_types:
        - aws_iam_group_membership
      operator:  exists
      cond_type: connection
    - resource_types:
        - aws_iam_group_membership
      connected_resource_types:
        - aws_iam_user
      operator:  exists
      cond_type: connection
    - cond_type: attribute
      attribute: users
      resource_types:
        - aws_iam_group_membership
      operator:  exists
    - cond_type: filter
      attribute: resource_type
      value:
        - aws_iam_group_membership
      operator: within
      
